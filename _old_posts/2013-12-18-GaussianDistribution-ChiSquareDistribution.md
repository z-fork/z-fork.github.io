---
title: Gaussian-distribution_Chi-square-distribution
layout: post
tags:
  - 正态分布
  - 卡方分布
---

**若 \\( X \sim N(0, 1) \\), 求 \\( Y = X^2 \\) 的概率密度函数 及 分布.**

X服从正态分布, 概率密度函数 \\( X \sim N(\mu, \sigma^2) \\).

$$
f(x) = {(\sqrt{2 \pi} \sigma)}^{-1} e^{\frac{-(x - \mu)^2}{2 \sigma^2}}, -\infty < x < \infty \label{1}
$$

因 \\( X \sim N(0, 1) \\), X的概率密度函数

$$
f(x) = {(\sqrt{2 \pi})}^{-1} e^{\frac{-(x)^2}{2}}
$$

----
附 1:

> 关于 \\( Y \\) 的概率密度函数一般求法

> \\( X \\) 有密度函数 \\( f(x) \\).

> 假设 \\( Y = g(x) \\), \\( g \\) 是一个严格上升的函数, 即当 \\( x_1 < x_2 \\) 时, 必有 \\( g(x_1) < g(x_2) \\).

> 假设 \\( g \\) 的导数 \\( g' \\) 存在, 由于 \\( g \\) 严格上升, 其反函数 \\( X = h(y) \\) 存在且 \\( h \\) 的导数 \\( h' \\) 也存在.

> 任取实数 \\( y \\). 因 \\( g \\) 严格上升, 有

> $$
P(Y \leq y) = P(g(x) \leq y) = P(X \leq h(y)) = \int_{-\infty }^{h(y)}f(t)dt
$$

> 对 \\( y \\) 求导得 \\( Y \\) 的概率密度函数 \\( l(y) \\).

----

因 \\( Y \\) 非负, 

当 \\( y \leq 0 \\)

$$
P(Y \leq y) = 0
$$

当 \\( y > 0 \\)

$$
P(Y \leq y) = P(X^2 \leq y) = P(-\sqrt{y} \leq X \leq \sqrt{y}) = \int_{-\sqrt{y} }^{\sqrt{y}}f(t)dt
$$

对 \\( y \\) 求导数, 得 \\( Y \\) 的密度函数 \\( l(y) \\)

**求导过程!!!**

**\\( t = ?? \\)**

$$
l(y) = \frac{1}{2} y^{-\frac{1}{2}}[f(\sqrt{y}) + f(\sqrt{y})]
$$

代入 \\( X \\) 的概率密度函数

$$
l(y) = {(\sqrt{2 \pi y})}^{-1} e^{\frac{-y}{2}}
$$

----
附 2:

> \\( \Gamma \\) 函数 \\( \Gamma(x) \\):

> $$
\Gamma(x) = \int_{0}^{\infty} e^{-t} t^{x-1}dt, x > 0
$$

> $$
\Gamma(\frac{1}{2}) = \sqrt(\pi)
$$

> $$
\Gamma(x + 1) = x \Gamma(x)
$$

> \\( \beta \\) 函数 \\( \beta(x) \\):

> $$
\beta(x) = \int_{0}^{1} t^{x-1} (1-t)^{y-1}dt, x > 0, y > 0
$$

> $$
\beta(x, y) = \frac{\Gamma(x)\Gamma(y)}{\Gamma(x + y)}
$$

> 卡方分布概率密度函数

> $$
k_n(x)=\left\{\begin{matrix}
\frac{1}{\Gamma (\frac{n}{2})2^{\frac{n}{2}}}e^{-\frac{x}{2}}x^{\frac{n-2}{2}} &, x > 0 \\ 
0 &, x \leq 0 & 
\end{matrix}\right.
$$

> 称为 "自由度 n的皮尔逊卡方密度", 记为 \\( \chi_n^2 \\).

----

当 n = 1 时, 因 \\( \Gamma (\frac{1}{2}) = \sqrt{\pi} \\)

$$
k_1(x) = {(\sqrt{2 \pi x})}^{-1} e^{-\frac{x}{2}}
$$

所以 \\( Y = X^2 \\) 服从自由度 \\( 1 \\) 的卡方分布 \\( \chi_1^2 \\).

----
----

**若 \\( X_1, \cdots, X_n \\) 相互独立, 都服从正态分布 \\( N(0, 1) \\), 则 \\( Y = X_1^2 + \cdots, + X_n^2 \\) 服从自由度 \\( n \\) 的卡方分布 \\( \chi_n^2 \\).**

根据上例 \\( n = 1 \\) 时成立.

于是可用归纳法, 设此结果当 \\( n \\) 改为 \\( n - 1 \\)时成立.

设

$$
Y = Z + X_n^2
$$

其中

$$
Z = X_{1}^2 + \cdots, + X_{n-1}^2.
$$

则由归纳假设, \\( Z \\) 有密度函数 \\( k\_{n-1}(x) \\) 服从自由度 \\( n-1 \\) 的卡方分布 \\( \chi_{n-1}^2 \\).

已知 \\( \chi_n^2 \\) 有密度函数 \\( k_{1}(x) \\) 服从自由度 \\( 1 \\) 的卡方分布 \\( \chi_1^2 \\).

因 \\( X_1, \cdots, X_n \\) 相互独立, Z 与 \\( X_n^2 \\) 独立. 

----
附 1:

**随机变量和的密度函数**

设 \\( X_1, X_2 \\) 的联合密度函数为 \\( f(x_1, x_2) \\), 求

$$
Y = X_1 + X_2
$$

的密度函数.

考虑事件

$$
\{Y \leq y\} = \{X_1 + X_2 \leq y\}
$$

按密度函数的定义有

$$
P(Y \leq y) = P(X_1 + X_2 \leq y) = \iint\limits_Bf(x_1, x_2)dx_1dx_2
$$

积分区域 \\( B \\) 为 \\( X_1 - X_2 \\) 平面中 \\( X_1 + X_2 = y \\) 直线下方部分.

将**重积分**化为**累积分**

先固定 \\( x_1 \\) 对 \\( x_2 \\) 积分, 积分范围为 \\( -\infty \\) 到 \\( y - x_1 \\), 再对 \\( x_1 \\) 从 \\( -\infty \\) 到 \\( \infty \\) 积分.

$$
P(Y \leq y) = \int_{-\infty}^{\infty} (\int_{-\infty}^{y-x_1}f(x_1, x_2)dx_2)dx_1
$$

对 \\( y \\) 求导数, 得 \\( Y \\) 的密度函数为

$$
l(y) = \int_{-\infty}^{\infty}f(x_1, y-x_1)dx_1 = \int_{-\infty}^{\infty}f(x, y-x)dx = \int_{-\infty}^{\infty}f(y-x, x)dx
$$

如果 \\( X_1, X_2 \\) 独立, 则 \\( f(x_1, x_2) = f_1(x_1)f_2(x_2) \\) 这时 \\( Y \\) 的密度函数为

$$
l(y) = \int_{-\infty}^{\infty}f_1(x)f_2(y-x)dx = \int_{-\infty}^{\infty}f_1(y-x)f_2(x)dx
$$

----

\\( Y \\) 的密度函数为

$$
l(y) = \int_{-\infty}^{\infty}f_1(x)f_2(y-x)dx
$$

代入 \\( Z, X_n^2 \\) 的概率密度函数

因 \\( k_{n}(t) \\) 在 \\( t > 0 \\) 时才不为 \\( 0 \\)

$$
l(y) = \int_{-\infty}^{\infty}k_{n-1}(x)k_1(y-x)dx = l(y) = \int_{0}^{y}k_{n-1}(x)k_1(y-x)dx
$$

代入卡方分布概率密度函数 \\( k_{n}(x) \\)

$$
l(y) = k_{n}(y)
$$

归纳证明完成.

----
----

卡方分布重要性质:

1. 设 \\( X_1, X_2 \\) 独立, \\( X_1 \sim \chi_m^2 \\), \\( X_2 \sim \chi_n^2 \\), 则
$$
X_1 + X_2 \sim \chi_{m+n}^2.
$$

2. 若 \\( X_1, \cdots, X_n \\) 独立, 且都服从指数分布, 则
$$
X = 2 \lambda (X_1 + \cdots + X_n) \sim \chi_{2n}^2.
$$

----
----
